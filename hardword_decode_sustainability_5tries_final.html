
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title id="title">HardWord</title>
  <style>
    :root{
      --bg1:#0b1220; --bg2:#0d1b2a;
      --panel: rgba(17,26,43,.8);
      --txt:#ecf2ff; --muted:#9fb3d1;
      --acc:#22c55e; --acc2:#16a34a;
    }
    *{box-sizing:border-box}
    body{margin:0;min-height:100vh;background:linear-gradient(160deg,var(--bg1),var(--bg2));color:var(--txt);font-family:system-ui,-apple-system,Inter,Segoe UI,Roboto,Arial}
    .wrap{max-width:920px;margin:0 auto;padding:20px}
    .card{background:var(--panel);backdrop-filter:blur(8px);border:1px solid rgba(255,255,255,.06);border-radius:16px;padding:18px;box-shadow:0 8px 30px rgba(0,0,0,.35)}
    h1{margin:0 0 8px;font-size:clamp(22px,4vw,30px)}
    .sub{color:var(--muted);font-size:14px;margin-bottom:14px}
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    input[type="text"]{background:#0e1626;border:1px solid #1f2a44;color:var(--txt);padding:10px 12px;border-radius:10px;min-width:220px;outline:none}
    label.switch{display:inline-flex;align-items:center;gap:8px;font-size:14px;color:var(--muted)}
    label.switch input{appearance:none;width:42px;height:24px;border-radius:999px;background:#1f2a44;position:relative;outline:none;cursor:pointer;border:1px solid #2a3b5d}
    label.switch input::after{content:"";position:absolute;top:2px;left:2px;width:18px;height:18px;border-radius:50%;background:#8aa3c8;transition:.2s}
    label.switch input:checked{background:linear-gradient(90deg,var(--acc),var(--acc2))}
    label.switch input:checked::after{transform:translateX(18px);background:#fff}
    button{background:linear-gradient(180deg,var(--acc),var(--acc2));border:none;color:#fff;padding:10px 14px;border-radius:12px;font-weight:600;cursor:pointer;box-shadow:0 6px 14px rgba(34,197,94,.25)}
    .hidden{display:none}
    .hud{display:flex;gap:10px;align-items:center;justify-content:space-between;margin:14px 0 8px}
    .tag{padding:6px 10px;border-radius:999px;font-size:12px;background:#0e1626;border:1px solid #20304f;color:#aac1e6}
    .timer{font-variant-numeric:tabular-nums;font-weight:700;border:1px solid #1f2a44;padding:6px 10px;border-radius:10px;min-width:86px;text-align:center}
    .board{display:grid;grid-template-rows:repeat(6,1fr);gap:8px;margin:12px auto;width:min(520px,94vw)}
    .rowg,.row{display:grid;gap:8px}
    .tile{aspect-ratio:1;border:2px solid #243247;border-radius:10px;display:flex;align-items:center;justify-content:center;font-size:clamp(18px,5vw,28px);font-weight:800;text-transform:uppercase;background:#0e1626;color:#e6eeff}
    .tile.filled{border-color:#334766}
    .tile.reveal{animation:flip .6s ease both}
    @keyframes flip{0%{transform:rotateX(0)}50%{transform:rotateX(90deg)}100%{transform:rotateX(0)}}
    .correct{background:#16a34a;border-color:#16a34a;color:#fff}
    .present{background:#f59e0b;border-color:#f59e0b;color:#fff}
    .absent{background:#1f2a44;border-color:#1f2a44;color:#9fb3d1}
    .kbd{display:grid;gap:8px;grid-template-columns:repeat(20,1fr);width:min(620px,96vw);margin:8px auto 0}
    .key{grid-column:span 2;background:#13223a;border:1px solid #244265;color:#dbe8ff;border-radius:10px;padding:10px 0;text-align:center;font-weight:700;cursor:pointer;user-select:none}
    .key.wide{grid-column:span 4}
    .hit{background:#16a34a;color:#fff;border-color:#16a34a}
    .ok{background:#f59e0b;color:#fff;border-color:#f59e0b}
    .dead{background:#1f2a44;color:#93a7c4}
    .toast{position:fixed;left:50%;top:14px;transform:translateX(-50%) translateY(-10px);background:#0e1626;border:1px solid #244265;padding:8px 12px;border-radius:10px;opacity:0;transition:.2s;box-shadow:0 6px 20px rgba(0,0,0,.35)}
    .toast.show{opacity:1;transform:translateX(-50%) translateY(0)}
    .end .code{font-family:ui-monospace,Menlo,Consolas,monospace;border:1px dashed #2a3b5d;padding:10px;border-radius:8px;margin-top:6px}
    .muted{color:#a6b8d6}
  
.rulebox{background:rgba(34,197,94,.1);border:1px solid var(--acc);color:#e3fce8;padding:8px 12px;border-radius:10px;font-size:15px;margin-bottom:12px;text-align:center;font-weight:600}
.rulebox.blue{background:rgba(59,130,246,.1);color:#dbe9ff}

  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1 id="title">HardWord</h1>
      <div class="rulebox">⏱️ 10 minutes • 5 tries per word • No clues</div>

      <!-- Start Screen -->
      <div id="start">
        <div class="row" style="margin-bottom:10px">
          <label for="name">Player Name:</label>
          <input id="name" type="text" placeholder="Type your name" maxlength="25"/>
          <button id="startBtn">Start Game</button>
        </div>
        <label class="switch" title="When ON, the end screen shows a shareable result code">
          <input id="lbToggle" type="checkbox"/>
          <span>Enable Leaderboard (shows result code)</span>
        </label>
      </div>

      <!-- Game Screen -->
      <div id="game" class="hidden">
        <div class="hud">
          <div class="tag"><strong>Words solved:</strong> <span id="progressWords">0</span></div>
          <div class="tag"><strong>Tries left:</strong> <span id="tries">6</span></div>
          <div class="tag"><strong>Word length:</strong> <span id="wordlen">5</span></div>
          <div class="timer" id="timer">10:00</div>
        </div>
        <div id="board" class="board"></div>
        <div id="kbd" class="kbd"></div>
      </div>

      <!-- End Screen -->
      <div id="end" class="end hidden">
        <h3>Time!</h3>
        <div id="endSummary" class="muted">—</div>
        <div style="display:flex;gap:8px;flex-wrap:wrap;margin-top:10px">
          <button id="copyBtn" class="hidden">Copy Result Code</button>
          <button id="restartBtn">Play Again</button>
        </div>
      </div>
    </div>
  </div>

<script>
window.HARDWORD_CONFIG = {
  title: "HardWord: Decode Sustainability",
  words: ["HUNGER","POWER","LIGHT"],
  totalSeconds: 600,
  attemptsPerWord: 5,
  theme: "green"
};
</script>

<script>
(function(){
  // -------- Config (overridden per file via window.HARDWORD_CONFIG) --------
  const CFG = window.HARDWORD_CONFIG || {
    title: "HardWord",
    words: ["SOLAR","GREEN","EARTH"],
    totalSeconds: 600, // 10 minutes
    attemptsPerWord: 6,
    theme: "green", // "green" | "blue"
  };

  // -------- State --------
  let playerName = "";
  let leaderboardOn = false;
  let timerId = null;
  let secondsLeft = CFG.totalSeconds;
  let currentWordIndex = 0;
  let currentTarget = "";
  let rowIndex = 0, colIndex = 0;
  let grid = []; // rows x cols (per word)
  let finished = false;
  let stats = []; // per-word results [{word, solved, tries, time}]
  let keyboardState = {}; // letter status
  let wordsQueue = []; // rotating queue of words

  // -------- DOM --------
  const $ = (s)=>document.querySelector(s);
  const startScreen = $("#start");
  const gameScreen = $("#game");
  const endScreen = $("#end");
  const nameInput = $("#name");
  const startBtn = $("#startBtn");
  const lbToggle = $("#lbToggle");
  const timerEl = $("#timer");
  const triesEl = $("#tries");
  const wordLenEl = $("#wordlen");
  const board = $("#board");
  const kbd = $("#kbd");
  const progressWords = $("#progressWords");
  const endSummary = $("#endSummary");
  const copyBtn = $("#copyBtn");
  const restartBtn = $("#restartBtn");
  const titleEl = $("#title");

  // -------- Utilities --------
  const pad = (n)=> (n<10?"0":"")+n;
  const fmt = (s)=> `${pad(Math.floor(s/60))}:${pad(s%60)}`;
  function setTheme(theme){
    if(theme==="blue"){
      document.documentElement.style.setProperty("--acc","#3b82f6");
      document.documentElement.style.setProperty("--acc2","#2563eb");
    } else {
      document.documentElement.style.setProperty("--acc","#22c55e");
      document.documentElement.style.setProperty("--acc2","#16a34a");
    }
  }

  function shuffle(arr){
    const a = arr.slice();
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i],a[j]]=[a[j],a[i]];
    }
    return a;
  }

  function nextTarget(){
    if(wordsQueue.length===0){
      wordsQueue = shuffle(CFG.words);
    }
    currentWordIndex++;
    const w = wordsQueue.shift();
    return w.toUpperCase();
  }

  function initKeyboard(){
    kbd.innerHTML="";
    const rows=["QWERTYUIOP","ASDFGHJKL","ZXCVBNM"];
    rows.forEach((r,ri)=>{
      for(const ch of r){
        const d=document.createElement("div");
        d.className="key";
        d.dataset.key=ch;
        d.textContent=ch;
        d.onclick=()=> press(ch);
        kbd.appendChild(d);
      }
      if(ri===1){
        const enter=document.createElement("div");
        enter.className="key wide";
        enter.dataset.key="ENTER";
        enter.textContent="ENTER";
        enter.onclick=()=> press("ENTER");
        kbd.appendChild(enter);
        const back=document.createElement("div");
        back.className="key wide";
        back.dataset.key="BACK";
        back.textContent="⌫";
        back.onclick=()=> press("BACK");
        kbd.appendChild(back);
      }
    });
  }

  function setKeyState(letter, state){
    const pri = {hit:3, ok:2, dead:1};
    const cur = keyboardState[letter] || null;
    if(cur && pri[cur] >= pri[state]) return;
    keyboardState[letter]=state;
    const el = [...kbd.querySelectorAll(".key")].find(k=>k.dataset.key===letter);
    if(!el) return;
    el.classList.remove("hit","ok","dead");
    el.classList.add(state);
  }

  function drawBoard(len){
    board.innerHTML="";
    for(let r=0;r<CFG.attemptsPerWord;r++){
      const row=document.createElement("div");
      row.className="row";
      row.style.gridTemplateColumns=`repeat(${len},1fr)`;
      for(let c=0;c<len;c++){
        const t=document.createElement("div");
        t.className="tile";
        row.appendChild(t);
      }
      board.appendChild(row);
    }
  }

  function paint(){
    const rows = board.querySelectorAll(".row");
    for(let r=0;r<CFG.attemptsPerWord;r++){
      const tiles = rows[r].children;
      for(let c=0;c<currentTarget.length;c++){
        const ch = grid[r][c]||"";
        tiles[c].textContent = ch;
        tiles[c].classList.toggle("filled", !!ch);
      }
    }
    triesEl.textContent = (CFG.attemptsPerWord - rowIndex);
    wordLenEl.textContent = currentTarget.length;
    progressWords.textContent = stats.length;
  }

  function startGlobalTimer(){
    clearInterval(timerId);
    secondsLeft = CFG.totalSeconds;
    timerEl.textContent = fmt(secondsLeft);
    timerId = setInterval(()=>{
      secondsLeft--;
      timerEl.textContent = fmt(secondsLeft);
      if(secondsLeft<=0){
        clearInterval(timerId);
        endGame();
      }
    },1000);
  }

  function startWord(){
    currentTarget = nextTarget();
    rowIndex=0; colIndex=0;
    grid = Array.from({length:CFG.attemptsPerWord}, ()=> Array(currentTarget.length).fill(""));
    keyboardState = {};
    drawBoard(currentTarget.length);
    initKeyboard();
    paint();
  }

  function press(key){
    if(finished) return;
    if(key==="ENTER"){ submit(); return; }
    if(key==="BACK"){ backspace(); return; }
    if(/^[A-Z]$/.test(key)){ addLetter(key); }
  }
  function addLetter(ch){
    if(colIndex>=currentTarget.length) return;
    grid[rowIndex][colIndex]=ch;
    colIndex++;
    paint();
  }
  function backspace(){
    if(colIndex===0) return;
    colIndex--;
    grid[rowIndex][colIndex]="";
    paint();
  }

  function submit(){
    const guess = grid[rowIndex].join("");
    if(guess.length !== currentTarget.length){
      toast("Not enough letters");
      return;
    }
    const tgt = currentTarget.split("");
    const arr = guess.split("");
    const res = Array(tgt.length).fill("absent");
    const freq = {};
    tgt.forEach(ch => freq[ch] = (freq[ch]||0)+1);
    for(let i=0;i<tgt.length;i++){
      if(arr[i]===tgt[i]){ res[i]="correct"; freq[arr[i]]--; }
    }
    for(let i=0;i<tgt.length;i++){
      if(res[i]==="absent" && freq[arr[i]]>0){ res[i]="present"; freq[arr[i]]--; }
    }
    const rowEl = board.querySelectorAll(".row")[rowIndex].children;
    for(let i=0;i<tgt.length;i++){
      setTimeout(()=>{ rowEl[i].classList.add("reveal", res[i]); }, i*120);
      // update keyboard
      const L = arr[i];
      if(res[i]==="correct") setKeyState(L,"hit");
      else if(res[i]==="present") setKeyState(L,"ok");
      else setKeyState(L,"dead");
    }
    const won = res.every(x=>x==="correct");
    if(won){
      stats.push({word: currentTarget, solved:true, tries: rowIndex+1, time: (CFG.totalSeconds - secondsLeft)});
      toast("Correct! ✅");
      setTimeout(()=> startWord(), 600);
      return;
    }
    rowIndex++;
    colIndex=0;
    paint();
    if(rowIndex>=CFG.attemptsPerWord){
      stats.push({word: currentTarget, solved:false, tries: CFG.attemptsPerWord, time: (CFG.totalSeconds - secondsLeft)});
      toast(`Out of tries! The word was ${currentTarget}.`);
      setTimeout(()=> startWord(), 600);
    }
  }

  function endGame(){
    finished = true;
    startScreen.classList.add("hidden");
    gameScreen.classList.add("hidden");
    endScreen.classList.remove("hidden");
    const solved = stats.filter(s=>s.solved).length;
    const total = stats.length;
    const used = CFG.totalSeconds - secondsLeft;
    const lines = stats.map(s => `${s.word} — ${s.solved?"Solved in "+s.tries+" tries":"Not solved"} — t=${fmt(s.time)}`).join("\n");
    const code = resultCode(playerName, stats, used);
    let html = `<div><strong>${playerName || "Player"}</strong></div>
    <div>Time used: <strong>${fmt(used)}</strong> • Words attempted: <strong>${total}</strong> • Solved: <strong>${solved}</strong></div>
    <pre style="white-space:pre-wrap;margin:10px 0">${lines||"No words attempted."}</pre>`;
    if(leaderboardOn){
      html += `<div class="muted">Result Code (share with host):</div>
      <div class="code">${code}</div>`;
      copyBtn.classList.remove("hidden");
    } else {
      copyBtn.classList.add("hidden");
    }
    endSummary.innerHTML = html;
    copyBtn.onclick = ()=> navigator.clipboard.writeText(code).then(()=> toast("Result code copied!"));
  }

  function toast(msg){
    const bar = document.createElement("div");
    bar.className="toast";
    bar.textContent = msg;
    document.body.appendChild(bar);
    setTimeout(()=> bar.classList.add("show"), 10);
    setTimeout(()=> { bar.classList.remove("show"); setTimeout(()=>bar.remove(),200); }, 1500);
  }

  function resultCode(name, stats, used){
    const N = (name||"PLAYER").toUpperCase().replace(/[^A-Z]/g,"").slice(0,8);
    const compact = stats.map(s=> `${s.solved?1:0}${("0"+s.tries).slice(-2)}${("000"+s.time).slice(-3)}`).join("-");
    const seed = (N + compact + "SDG10MINS").split("").reduce((a,c)=> (a*31 + c.charCodeAt(0)) % 100000, 11);
    return `${N}|${compact}|${("00000"+seed).slice(-5)}|${("0000"+used).slice(-4)}`;
  }

  // -------- Event wiring --------
  startBtn.addEventListener("click", ()=>{
    playerName = nameInput.value.trim();
    leaderboardOn = lbToggle.checked;
    if(!playerName){ toast("Please enter your name"); return; }
    finished = false;
    stats = [];
    startScreen.classList.add("hidden");
    endScreen.classList.add("hidden");
    gameScreen.classList.remove("hidden");
    setTheme(CFG.theme);
    titleEl.textContent = CFG.title;
    document.addEventListener("keydown", (e)=>{
      if(finished) return;
      if(e.key==="Enter") press("ENTER");
      else if(e.key==="Backspace") press("BACK");
      else if(/^[a-zA-Z]$/.test(e.key)) press(e.key.toUpperCase());
    });
    startGlobalTimer();
    startWord();
  });

  restartBtn.addEventListener("click", ()=>{
    // Return to start so the host can toggle leaderboard again if desired
    endScreen.classList.add("hidden");
    startScreen.classList.remove("hidden");
    gameScreen.classList.add("hidden");
  });
})();
</script>

</body>
</html>
